Case Study: How Can a Wellness Technology Company Play It Smart?
================
Anatoli Ignatov
2025-07-20

## 1. Ask

### Business Task

Bellabeat wants to better understand how consumers use smart wellness
devices in order to improve their marketing strategy. Specifically, we
need to identify usage trends from non‑Bellabeat smart device data and
apply those insights to help one Bellabeat product grow its market
share.

### How can the insights drive business decisions?

By uncovering real user behavior patterns, the insights will help the
Bellabeat team to:

- Identify the most popular features users engage with (activity, sleep,
  hydration, etc.).  
- Discover daily and weekly usage patterns.  
- Reveal gaps or opportunities for Bellabeat to promote its own
  products.  
- Create targeted marketing strategies aligned with actual usage trends.

### Key Stakeholders

- **Urška Sršen** (Cofounder & Chief Creative Officer) – initiated the
  analysis  
- **Sando Mur** (Cofounder & Executive Team) – interested in growth
  strategy  
- **Bellabeat Marketing Analytics Team** – will operationalize the
  insights  
- **Bellabeat Executive Team** – needs strategic recommendations for
  product positioning

------------------------------------------------------------------------

## 2. Prepare

### Data Source

Public data from
[Kaggle](https://www.kaggle.com/datasets/arashnic/fitbit). Originally
shared by Fitbit. The dataset was generated by respondents to a
distributed survey via Amazon Mechanical Turk between 03.12.2016 and
05.12.2016.

### Data Organization

- **Minute‑level tables** (e.g., `minuteSleep_merged`,
  `hourlySteps_merged`): long format, one row per minute or hour.  
- **Daily‑level table** (`dailyActivity_merged`): wide format, one row
  per user per day, with separate columns for each activity metric.

### Data Preparation

1.  Downloaded the two .rar files for two time periods - “Fitabase Data
    March 12 to April 11” and “Fitabase Data April 12 to May 12”.  
2.  Made copies of the originals;
3.  Renamed and organized the copies in a dedicated project folders.

### Initial Assessment

- Small, non‑representative sample.  
- Outdated (2016).  
- Only 24 users have sleep data; heart rate and weight tables largely
  incomplete.  
- No demographic variables (age, gender, location).

------------------------------------------------------------------------

## 3. Process

### Tools Used

- **Google BigQuery** for data ingestion, cleaning, filtering, and
  joins.  
- **Tableau** for analysis, visualization and dashboarding.

### Data Preparation

#### Step 1:

Uploaded raw CSVs directly; manually defined schemas where
auto‑detection failed.

#### Step 2:

**Data Consolidation** - Combined datasets from two time periods
`12_03_2016_to_11_04_2016` and `12_04_2016_to_12_05_2016` using
`UNION ALL` across all tables.

#### Step 3:

**Key Cleaning Operations** - Date/time standardization:

- `PARSE_DATE/PARSE_DATETIME` to convert string timestamps to proper
  date/time formats.

- Handled 12-hour (`%I:%M:%S %p`) and 24-hour (`%H:%M`) formats

**Data validation**:

- Filtered out records with `NULL` or empty timestamp fields

- Removed invalid records (e.g., `TotalSteps <= 0`, `Calories <= 0`)

- Trimmed whitespace from text fields

#### Step 4:

**Table-Specific Transformations** - Heart Rate Data:

- Aggregated second-level data to minute intervals

- Calculated `AvgHeartRate` per minute

- All Tables: Standardized timestamp column names to `Timestamp`

#### Step 4:

**Output Structure** - Created/replaced tables in
`Fitabase_Data_Combined` dataset with consistent naming conventions.

### Data Transformation

To power Tableau dashboards and speed up queries, we aggregated and
joined the cleaned tables into a few “summary” tables:

1.  **Daily user activity** (`user_daily_activity`):  

- One row per user per day  
- Calculates average steps & calories, plus sums of active and sedentary
  minutes  

``` sql
CREATE OR REPLACE TABLE user_daily_activity AS
SELECT
  Id,
  DATE(Timestamp) AS Date,
  AVG(TotalSteps) AS avg_steps,
  SUM(VeryActiveMinutes) AS very_active_mins,
  SUM(FairlyActiveMinutes) AS moderately_active_mins,
  SUM(LightlyActiveMinutes) AS lightly_active_mins,
  SUM(SedentaryMinutes) AS sedentary_mins,
  AVG(Calories) AS avg_calories
FROM dailyActivity_merged
GROUP BY Id, Date;
```

2.  **Daily sleep summary** (`user_sleep_summary`)

- One row per user per day
- Counts minutes asleep, restless, awake, and computes sleep efficiency
  %

``` sql
CREATE OR REPLACE TABLE user_sleep_summary AS
SELECT
  Id,
  DATE(Timestamp) AS Date,
  COUNTIF(SleepValue = 1) AS sleep_minutes,
  COUNTIF(SleepValue = 2) AS restless_minutes,
  COUNTIF(SleepValue = 3) AS awake_minutes,
  ROUND( COUNTIF(SleepValue = 1) / NULLIF(COUNT(*),0) * 100 , 1 ) AS sleep_efficiency_pct
FROM minuteSleep_merged
GROUP BY Id, Date;
```

3.  **Hourly combined activity** (`hourly_activity`)

- One row per user per hour
- Joins steps, calories, and intensity; computes averages

``` sql
CREATE OR REPLACE TABLE hourly_activity AS
SELECT
  s.Id,
  EXTRACT(DATE FROM s.Timestamp) AS Date,
  EXTRACT(HOUR FROM s.Timestamp) AS Hour,
  AVG(s.Steps) AS avg_steps,
  AVG(c.Calories) AS avg_calories,
  AVG(i.TotalIntensity) AS avg_intensity
FROM hourlySteps_merged AS s
JOIN hourlyCalories_merged AS c USING(Id, Timestamp)
JOIN hourlyIntensities_merged AS i USING(Id, Timestamp)
GROUP BY s.Id, Date, Hour;
```

4.  **User master table** (`user_master`)

- One row per user
- Captures first/last active dates, total active days, and assigns an
  activity segment

``` sql
CREATE OR REPLACE TABLE user_master AS
SELECT
  Id,
  MIN(DATE(Timestamp)) AS first_active_date,
  MAX(DATE(Timestamp)) AS last_active_date,
  COUNT(DISTINCT DATE(Timestamp)) AS active_days,
  CASE
    WHEN AVG(TotalSteps) < 5000 THEN 'Sedentary'
    WHEN AVG(TotalSteps) BETWEEN 5000 AND 7499 THEN 'Lightly Active'
    ELSE 'Active'
  END AS activity_segment
FROM dailyActivity_merged
GROUP BY Id;
```

------------------------------------------------------------------------

## 4. Analyze & 5. Share

### Key FIndings:

#### User Engagement Overview

**35 Total users**

- 24 tracked sleep
- 17 classified as active
- 8 lightly active
- 10 predominantly sedentary

#### Sleep Quality Insights

- Higher restlessness correlates with lower sleep efficiency.
- Restlessness peaks on Mondays and Saturdays, suggesting stress or
  lifestyle factors.

#### Physical Activity Patterns

**Seasonality**

- March shows lowest average daily steps.
- April & May show a gradual increase as weather improves.

#### Hourly Activity Heatmap

A heatmap was created to show users’ steps by hour. However, the data
lacks timezone normalization, making the hourly pattern unreliable for
insights across users.

### Vizualizations

These insights have been integrated into an interactive Tableau
dashboard. You can explore the detailed charts here:

[Bellabeat Case Study
Dashboard](https://public.tableau.com/views/BellabeatCaseStudyDashboard_17530214351850/Dashboard1?:language=en-US&publish=yes&:sid=&:redirect=auth&:display_count=n&:origin=viz_share_link)

------------------------------------------------------------------------

## 6. Act

### Strategic Recommendations

1.  **Target Sedentary Users with Personalized Challenges**

- 10 of 35 users are inactive.  
- Launch in‑app step challenges with beginner goals and motivational
  prompts.

2.  **Enhance Sleep Awareness Campaigns**

Since 11 users do not track sleep and restlessness peaks on certain
nights:

- Educate users on sleep efficiency and offer weekly sleep reports
- Suggest guided wind‑down routines before high‑stress nights.

3.  **Seasonal Marketing Programs**

- Activity rises in spring (April/May).  
- Bellabeat can align its marketing to promote seasonal challenges or
  discounts on accessories (e.g., smartbands) in early spring.

------------------------------------------------------------------------

## Final Reflections

This Bellabeat case study presented far more complexity than
anticipated. The dataset spanned multiple time granularities — minute,
hourly, and daily — and included a broad array of metrics (steps,
calories, heart rate, sleep stages, weight logs), the small number of
users (35) and the large amount of missing or inconsistent data made
reliable analysis difficult. The limited ~60‑day window further
constrained trend detection, and uneven coverage across tables (for
example, only 24 users with sleep data and sparse heart‑rate logs)
required extensive trial and error to find workable aggregation
strategies.

Working through the data preparation and transformation phases took
substantially longer than my previous project. Reconciling different
timestamp formats, handling nulls, and validating joins across so many
tables tested both technical skills and patience. At times, I questioned
the suitability of this dataset as a beginner case study—its gaps and
anomalies demanded more advanced data‑engineering approaches than basic
cleaning techniques.

Despite these challenges, the process deepened my understanding of
real‑world data issues: no dataset is perfect, and robust analytics
often depend on creative problem‑solving to work around limitations. In
the future, I plan to revisit this case with a broader time span and
additional skillset to build more confident insights. For now, this
version represents my best effort under the given constraints and serves
as a valuable learning experience in managing complex, incomplete data.

Anatoli Ignatov
